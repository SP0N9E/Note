## 计算机动画复习

[TOC]

### 动画基本知识、动画形成的视觉原理

- ‘animate’ == ‘to give life to’  
- 移动不能自己移动的物体
- 在图形上加上时间这一维度
- 动画师指定物体如何在时间或者空间域上移动
- 运动是动画的要素

**动画**：通过以每秒若干帧的速度顺序地播放静止图像帧以产生运动错觉的艺术

**视觉原理**：利用了人的视觉残留这一特点，即上个画面的残留还未小时，下一个画面又进入视觉，这样循环往复，在人的眼中形成动态的画面



### 传统动画应用于三维计算机动画的基本原则

- Squash and Stretch 挤压和伸展

  通过物体形变来表现物体的刚度和质量，通常使变形的物体保持体积不变。e.g.肌肉变形

- Anticipation 预期性

  动画中的动作通常包括动作的准备、实际的动作和动作的完成三部分。第一部分就叫做预期性。

- Staging 布局

  布局就是以一种容易理解的方式展示动作或对象。角色的仪态及表演方式，配合适当的摄影机运动，使得动
  画能够有效地表达角色的特性及故事中的信息；如果角色、环境和道具放置得不合理，会使得观众分心和
  困惑。  

  <img src=".\img\1.jpg" alt="1" style="zoom:50%;" />

- Straight-Ahead Action and Pose-to-Pose Action 连贯动作法与关键动作法

  属于两种不同的动画制作方式

  前者根据连续的动作依序制作每一帧画面

  后者是先定义关键的主要动作，而后再制作关键动作间的画面(关键帧方法)

- Follow-Through and Overlapping Action 跟随动作与重叠动作

  动者恒动。当一个物体运动的时候，身上部分也会一起动

- Slow In and Slow Out 慢入慢出

  慢入和慢出是指动作的加速和减速。自然界中物体的运动具有加速和减速的性质  

- Arcs 弧形动作

  在制作动画时，角色的运动轨迹就不应是直线，而应该是比较自然的曲线。 

  只有在特殊的情况下，角色或者角色的一部分会完全沿着直线运动  

- Secondary Action 附属动作

  当角色进行主要动作时，附属于角色的部分，例如触须、尾巴等，会以附属动作来点缀主要动作的效果  

  附属运动为动画增添乐趣和真实性  

-  Timing 掌握时序

  时间的调配和选择是影响动画效果的最关键因素之一。

  掌握动画节奏！通过时序来表现物体的大小、重量和个性  

- Exaggeration 夸张

  夸张手法用于强调某个动作，但使用时应小心谨慎，不能随意。使用夸张手法时，要注意明确动作或者序列的表现目标，然后确定哪一部分需要夸大表现。使用夸张的结果通常是动画更加真实和有趣。  

- Solid drawing

- Appeal 吸引力

  吸引力是指任何观众愿意观看的东西,以表现出角色的个性。

  目标：建立角色与观众的某种联系

  当设计角色时，以独特的造型或姿态来提高观众对角色的印象。例如高矮胖瘦可分别代表角色的不同个性  

- Depth of Field 景深

  焦点附近的物体很清晰，而离焦点远的景物变模糊

  

- Balance & Weight 平衡及重量感

  了解运动物体的重心所在，重心的位置可影响物体在视觉上的稳定度；

  物体在视觉上的轻重如何，除了在造型上予以定义外，也需由动作来表现物体的重量感  



### 2D Shape Blending涉及哪两个子问题？基于内在形状插值的多边形渐变方法的基本思想？Edge Tweaking的思想？

#### 两个子问题

1. 顶点的对应关系问题
2. 顶点的插值问题

#### 基于内在形状插值的多边形渐变方法的基本思想

1. 乌龟几何

   ![2](.\img\2.jpg)

   ![3](.\img\3.jpg)

   

   

2. Lagrange乘数法优化

3. 对关键帧多边形的边长和顶点角进行插值

   乌龟几何使得我们可以获取边长和顶点

   ![4](.\img\4.jpg)

   

#### Edge Tweaking的基本思想

上述插值过程中会出现头尾不相接的问题，为了解决，提出Edge Tweaking

<img src=".\img\5.jpg" alt="5" style="zoom:67%;" />

<img src=".\img\6.jpg" alt="6" style="zoom:67%;" />

<img src=".\img\7.jpg" alt="7" style="zoom:67%;" />

#### 内在形状插值法的优缺点

- 优点：简单；能在一定程度上避免形状插值中出现的收缩和纽结现象，这在二维角色动画中尤其有用。
- 缺点：不能处理曲线形状；  当源和目标多边形中包含短边时，由于计算短边的方向不稳定，中间帧多边形有可能产生较严重的畸变。



### 图像morphing的原理

![8](.\img\8.jpg)



### 基于网格的图像morphing原理

采用的网格通常为双三次样条曲面，如Bezier样条曲面、 Catmull-Rom样条曲面等  

<img src=".\img\9.jpg" alt="9" style="zoom:80%;" />

<img src=".\img\10.jpg" alt="10" style="zoom:80%;" />

逆向映射：去源图像上寻找当前点的颜色等属性值

<img src=".\img\11.jpg" alt="11" style="zoom:80%;" />



### 基于线对的图像morphing方法

**优点**：直观

**缺点**：有可能生成一些意料之外的图像

采用逆向映射的方法，两幅图像之间的变换可以用一对直线来指定

- 单对线对变换：

<img src=".\img\12.jpg" alt="12" style="zoom:80%;" />

<img src=".\img\13.jpg" alt="13" style="zoom:80%;" />

<img src=".\img\14.jpg" alt="14" style="zoom:80%;" />

- 多对线对变换：

  <img src=".\img\15.jpg" alt="15" style="zoom:80%;" />

  <img src=".\img\16.jpg" alt="16" style="zoom:80%;" />

  

### 二、三维形状渐变(morphing)各有什么优缺点

#### 二维

- 优点

  计算简单

- 缺点

  二维图像对应的物体存在没有三维几何信息，因此不能像三维物体一样进行几何变换

#### 三维

- 优点

  能生成更加逼真和生动的特技效果

  能生成精确的光照和阴影效果

  一旦得到中间帧物体序列，就可以用不同的摄像机角度和光照条件对他们进行重画，也可以把他们与其他的三维场景相结合进行绘制

- 缺点

  计算复杂



### 基于星型物体的多面体morphing方法

该方法通过合并一对三维多面体物体模型的拓扑结构，使得它们具有相同的顶点/边/面网络结构，然后对相应的顶点进行插值。

  <img src=".\img\17.jpg" alt="17" style="zoom:67%;" />

​	通过合并拓扑结构将这一个物体的形状变换为另一个物体的形状通常可分为以下两步：

- 建立原物体表面上的点与目标物体上的点对应关系——对应问题
- 插值对应的点——插值问题

建立点的对应关系是难点，而插值问题则比较简单

<img src=".\img\18.jpg" alt="18" style="zoom:67%;" />

<img src=".\img\19.jpg" alt="19" style="zoom:67%;" />

![20](.\img\20.jpg)

![21](.\img\21.jpg)

顶点对应关系建立后，通常采用线性插值或Hermite插值来插值相应的顶点

**插值可能出现的问题：**

- 对于边数大于3的面，在顶点插值过程中，原来共面的面有可能变成不共面。一个解决方法是在插值前对和的面三角化  
- 插值过程中物体有可能自交

对于如颜色、纹理、透明度等非几何属性的插值问题，可采用以下方法：

- 对于中间帧模型的某一点，计算该点再相应面的面积坐标
- 根据该面积坐标，计算出该点在原关键帧物体中相应的点
- 插值原关键帧物体中相应点的非几何属性



### 基于体表示的三维morphing方法

1. **思想**

   给定源体S和目标体T，与二维图像morphing的思想类似，该方法首先根据指定的对应特征生成一空间变换，该变换使给定的两个体扭曲变形（warp）成S'和T'，达到几何对齐的目的。然后对得到的两个扭曲变形体S'和T‘进行混合。

2. 优点与缺点：

   优点：

   基于体的三维morphing方法与物体的几何和拓扑结构无关  

   由于多面体、 NURBS等几何表示的物体可以转化为体表示，基于体表示的morphing提供了一种统一的处理方法  

   缺点：

   走样现象较为严重，结果的精度通常没有基于几何表示的三维morphing方法好  

   为了获得较高精度的体素表示，几何模型需要扫描转换为300×300 × 300或者更高的体素表示，计算时间较费。  

3. 几何对齐

   ![22](.\img\22.jpg)

   

4. 插值与逆向映射

   ![23](.\img\23.jpg)

   ![24](.\img\24.jpg)

   

5. 多对特征元素时选择加权处理

6. 距离$d_i$的计算方法

   ![25](.\img\25.jpg)

   



### 粒子系统的基本原理

1. 基本假设

   - 粒子一般与其他粒子不碰撞
   - 除非处于聚集状态，粒子不向其他粒子投射阴影
   - 粒子只向其他环境投射阴影
   - 粒子不反射光
   - 粒子通常有有限的生命周期

   

2. 基本思想

   将许多简单形状的微小粒子作为基本元素聚集起来形成一个不规则的模糊物体，每个粒子均经历出生、成长、衰老和死亡的过程，与粒子有关的每一参数均将受到一个随机过程的控制。

3. 步骤

   - 生成新的粒子并加入系统中  
   - 赋予每一新粒子以一定的属性  
   - 删除那些已经超过其生命周期的粒子  
   - 根据粒子的动态属性对粒子进行移动和变换  
   - 绘制并显示由有生命的粒子组成的图形  



### Boids模型的三条原则，每条原则的含义

<img src=".\img\31.jpg" alt="31" style="zoom:67%;" />



### Reynolds导航方法中的追逐和躲避模型、障碍避免模型、路径跟随、流场跟随行为模型、领导模型

#### 追逐和躲避模型

类似于“寻找和逃离”模型，只是目标变为移动的物体。

<img src=".\img\32.jpg" alt="32" style="zoom: 67%;" />

<img src=".\img\33.jpg" alt="33" style="zoom:67%;" />

#### 障碍避免模型

<img src=".\img\34.jpg" alt="34" style="zoom:67%;" />

<img src=".\img\35.jpg" alt="35" style="zoom:67%;" />

**徘徊：**一种随机导航；

<img src=".\img\36.jpg" alt="36" style="zoom:80%;" />



#### 路径跟随模型

<img src=".\img\37.jpg" alt="37" style="zoom:80%;" />

**沿墙运动：**首先根据当前的速度预测一定时间后车辆的位置，把该位置投影到墙上离它最近的点(红点)，把该点沿墙的法向(红线)移动给定的偏移量，从而生成一个目标点(红色的圆)。最后采用寻找(Seek)行为来接近目标点  

![38](.\img\38.jpg)

**抑制：**类似于沿墙运动；车辆使用抑制行为使得它原理标记为灰色的区域。与之前的障碍避免密切相关，但是这种行为可以处理任意形状，并允许车辆导航接近障碍物的表面。

车辆通过探测点测试前面的空间(用白线表示), 当没有接触障碍物时，车辆将采用徘徊行为，以避免使得它的运动与“通道”对齐。当探测点接触到障碍物时，把该点投影到障碍物的表面，并计算这点的法向，沿法向偏移一定量的点作为Seek目标进行导航



#### 流场跟随行为

<img src=".\img\39.jpg" alt="39" style="zoom:80%;" />

#### 领导模型

<img src=".\img\40.jpg" alt="40" style="zoom:80%;" />



### 基于社会力模型的群体行为模拟方法的基本原理

- 社会力模型以牛顿动力学为基础，由各个力的表达式来体现行人不同的动机和影响。在社会力模型中，由于对影响个体的因素考虑得比较全面，对个体行为的建模比较合理，该模型可以逼真地模拟人群的疏散过程  
- 个体的实际行为受主观意识、 其他个体及障碍物三方面因素的影响，均可等效为力在个体上的作用  

<img src=".\img\41.jpg" alt="41" style="zoom:80%;" />

![42](.\img\42.jpg)



### 相互速度障碍物（RVO）原理

- 假设个体以匀速前进  
- 每个个体在保持与周围个体相对运动的同时， 在速度域中计算出可能导致碰撞的速度集合，并对自身速度进行必要的调整。在调整过程中，碰撞避免的任务同时分配给相关的个体，使它们相互协调完成碰撞避免任务  

原先的速度障碍物(VO)会出现振荡的情况，这是因为智能体之间没有通讯或者整体的协调

**简单的想法：不是选择位于速度障碍物外部的一个新的速度，而是选择当前速度和一个位于速度障碍物外部的速度的平均**  

但这样环境可能变得很拥挤：没有有效的速度

<img src=".\img\43.jpg" alt="43" style="zoom:80%;" />

适用于大规模人群



### 正向运动学、逆向运动学（IK）原理

- 关节空间：由关节角形成的空间；可对所有关节进行细微控制

- 笛卡尔空间：三维空间；指定与环境的相互作用

- 正向运动学：从关节空间映射到笛卡尔空间

- 逆向运动学：从笛卡尔空间映射到关节空间

1. 正向运动学

   - 计算整颗树

     从根节点到叶节点进行深度优先遍历

     重复以下步骤，直到所有节点和连接弧都被访问过
      对树进行回溯，直到遇到一个未被访问过的向下连接弧
      对向下连接弧进行遍历  

   - 例子

     <img src=".\img\44.jpg" alt="44" style="zoom:80%;" />

     

2. 逆向运动学

- 给定初始姿态向量和目标姿态向量， 计算关节向量的值，使得物体满足所需的姿势  

  可以有0个、1个或多个解

- 存在问题：

  2个方程3个未知数有无穷多个解、无解

- 一旦得到关节向量值后，我们可对角色的初始姿势和最终姿势的关节向量值进行插值，从而得到角色的动画  

  但是如果初始和最终姿势向量有很大差异时，动画效果可能并不好。 

  解决方法：插值姿态向量； 对每个得到的插值姿态向量进行IK计算，得到中间某一时刻的关节向量值  

  

- 逆向运动学求解方法：

  解析法Vs数值计算

  关节链非常简单的时候，才会存在解析解

  数值增量法：逆向雅各比方法



### 逆向雅各比方法求解IK的原理

<img src=".\img\45.jpg" alt="45" style="zoom:80%;" />

<img src=".\img\46.jpg" alt="46" style="zoom:80%;" />

<img src=".\img\47.jpg" alt="47" style="zoom:80%;" />

![48](.\img\48.jpg)

还得好好看看



### 循环坐标下降法原理（CCD）

<img src=".\img\49.jpg" alt="49" style="zoom:80%;" />





### 运动捕获系统（MOCAP）流水线

1. 介绍

   运动捕获(MoCAP, Motion Capture)采用软硬件系统记录表演者的真实运动信息，并把动作过程复制到一个虚拟的人或动物上  

   运动捕获可以获取表演者动作的个性和运动细节，是生成逼真人体动画最实用、最有效的方法，因而在影视特技、游戏、动画、机器人控制中被广泛采用  

2. 主要思路

   - 跟踪参考点的运动
   - 把参考点的信息转化为关节角度
   - 用关节角驱动关节模型
   - 结合运动轨迹，进行角色的控制

3. 流水线

   - 标定
   - 捕获
   - 三维位置重建
   - 拟合到骨架
   - 后处理

   



### 基于运动捕获的关节动画制作的优缺点

1. 优点

   只要能被捕获，可记录人体运动的所有细节，运动真实

2. 缺点

   不容易进行：编辑、控制

   较昂贵

   



### 骨架与角色模型的绑定原理，顶点混合的原理，顶点混合的数学表示

#### 骨架与角色模型的绑定原理

在骨架绑定中，皮肤的运动定义为对应控制骨架的函数。

很多骨架绑定系统采用一个称为中性姿势或静止姿势的几何信息。



#### 顶点混合的原理

![50](.\img\50.jpg)





#### 顶点混合的数学表示

<img src=".\img\51.jpg" alt="51" style="zoom:80%;" />

<img src=".\img\52.jpg" alt="52" style="zoom:80%;" />





### 基于Blend Shapes表情动画的原理

<img src=".\img\53.jpg" alt="53" style="zoom:80%;" />



### Deformation和Morphing的区别。与物体表示无关的变形原理

**变形(Deformation)**是指将几何对象的形状作某种扭曲、形变， 使它形成到动画师所需的形状。 在这种变化中，**几何对象的拓扑关系保持不变**  

**区别：**空间变形更具某种随意性，所以空间变形也常称为自由变形（FFD）

<img src=".\img\54.jpg" alt="54" style="zoom:80%;" />









### 扩展的FFD方法EFFD的原理

1. 基础——FFD

   不直接操作物体，而是将物体嵌入一空间，当所嵌的空间变形时，物体也随之变形。  

   FFD一个重要性质是参数曲面变形后仍然是参数曲面  

   FFD的另一个性质使能对变换前后的体积变化进行控制  

   <img src=".\img\55.jpg" alt="55" style="zoom:80%;" />

   

2. FFD是一个非常直观的变形工具，但它只适合于平行六面体的lattice形状

   <img src=".\img\56.jpg" alt="56" style="zoom:80%;" />

#### EFFD：

允许FFD型lattice作为它结构的一部分，许多个FFD型lattice可合并构成EFFD的lattice  

<img src=".\img\57.jpg" alt="57" style="zoom:80%;" />

<img src=".\img\58.jpg" alt="58" style="zoom:80%;" />



### 基于cage的变形原理

![59](.\img\59.jpg)



### Laplacian的微分坐标及其变形原理





### 布料动画的核心问题，布料的物理机械性能主要包括那几种力？

#### 核心问题

![60](.\img\60.jpg)

<img src=".\img\61.jpg" alt="61" style="zoom:80%;" />

材料角度：无法准确预知织物的力学性能

#### 布料的物理机械性能

拉伸力、压缩力、剪切力、弯曲力

### Provot的衣服模型原理

#### 弹簧-质点模型：

<img src=".\img\62.jpg" alt="62" style="zoom:80%;" />

<img src=".\img\63.jpg" alt="63" style="zoom:80%;" />

<img src=".\img\64.jpg" alt="64" style="zoom:80%;" />

<img src=".\img\65.jpg" alt="65" style="zoom:80%;" />



### 布料动画中大步长隐式方法的原理

![65](.\img\65.jpg)



### 隐式曲面表示的优缺点

元球造型是一种隐式曲面造型技术，该技术采用具有等势场值的点集来定义曲面。因此，元球生成的面实际上是一张等势面 。

隐式曲面举例： 两个水滴融合成一个水滴

**优点：**

​	很容易判断一个点是否在曲面上

​	很容易计算曲面的交/并/差

​	很容易处理拓扑变化

**缺点：**

​	曲面通过间接指定

​	很难描述尖锐特征

​	很难对曲面上的点进行枚举

​	绘制慢



### 隐式曲面核函数的选择.Wyvill的六次多项式势函数的图形形状

![67](.\img\67.jpg)

![68](.\img\68.jpg)



### 碰撞检测中如何选择包围体

- 有很多选择
- 更好的包裹是更好的选择
- 物体形状越简单，效果越好
- 具有旋转不变性的包围体更好



### 离散有向多面体k-DOP

<img src=".\img\69.jpg" alt="69" style="zoom:80%;" />

<img src=".\img\70.jpg" alt="70" style="zoom:80%;" />

<img src=".\img\71.jpg" alt="71" style="zoom:80%;" />

实验结果表明，14或18-DOP具有最好的性能



### 碰撞检测中的分离轴定理

<img src=".\img\72.jpg" alt="72" style="zoom:80%;" />

### 求交测试的重要规则

![73](.\img\73.jpg)



































